{"version":3,"names":["h","classNames","remoteFileObjToLocal","useMemo","VirtualList","SearchFilterInput","FooterActions","Item","VIRTUAL_SHARED_DIR","ListItem","props","currentSelection","uppyFiles","viewType","isChecked","toggleCheckbox","recordShiftKeyPress","showTitles","i18n","validateRestrictions","getNextFolder","columns","f","isFolder","_isChecked","id","title","name","getItemIcon","icon","event","type","isDisabled","loading","isCheckboxDisabled","handleFolderClick","restrictionError","author","Browser","folders","files","headerComponent","showBreadcrumbs","handleScroll","isLoading","showSearchFilter","search","searchTerm","clearSearch","searchOnInput","searchInputLabel","clearSearchLabel","cancel","done","noResultsLabel","loadAllFiles","selected","length","rows","className","class","inputLabel","inputClassName","data","renderRow","rowHeight","onScroll","role","tabIndex","map"],"sources":["Browser.jsx"],"sourcesContent":["import { h } from 'preact'\n\nimport classNames from 'classnames'\nimport remoteFileObjToLocal from '@uppy/utils/lib/remoteFileObjToLocal'\nimport { useMemo } from 'preact/hooks'\nimport VirtualList from '@uppy/utils/lib/VirtualList'\nimport SearchFilterInput from './SearchFilterInput.jsx'\nimport FooterActions from './FooterActions.jsx'\nimport Item from './Item/index.jsx'\n\nconst VIRTUAL_SHARED_DIR = 'shared-with-me'\n\nfunction ListItem (props) {\n  const {\n    currentSelection,\n    uppyFiles,\n    viewType,\n    isChecked,\n    toggleCheckbox,\n    recordShiftKeyPress,\n    showTitles,\n    i18n,\n    validateRestrictions,\n    getNextFolder,\n    columns,\n    f,\n  } = props\n\n  if (f.isFolder) {\n    return Item({\n      columns,\n      showTitles,\n      viewType,\n      i18n,\n      id: f.id,\n      title: f.name,\n      getItemIcon: () => f.icon,\n      isChecked: isChecked(f),\n      toggleCheckbox: (event) => toggleCheckbox(event, f),\n      recordShiftKeyPress,\n      type: 'folder',\n      isDisabled: isChecked(f)?.loading,\n      isCheckboxDisabled: f.id === VIRTUAL_SHARED_DIR,\n      handleFolderClick: () => getNextFolder(f),\n    })\n  }\n  const restrictionError = validateRestrictions(remoteFileObjToLocal(f), [\n    ...uppyFiles,\n    ...currentSelection,\n  ])\n\n  return Item({\n    id: f.id,\n    title: f.name,\n    author: f.author,\n    getItemIcon: () => f.icon,\n    isChecked: isChecked(f),\n    toggleCheckbox: (event) => toggleCheckbox(event, f),\n    recordShiftKeyPress,\n    columns,\n    showTitles,\n    viewType,\n    i18n,\n    type: 'file',\n    isDisabled: restrictionError && !isChecked(f),\n    restrictionError,\n  })\n}\n\nfunction Browser (props) {\n  const {\n    currentSelection,\n    folders,\n    files,\n    uppyFiles,\n    viewType,\n    headerComponent,\n    showBreadcrumbs,\n    isChecked,\n    toggleCheckbox,\n    recordShiftKeyPress,\n    handleScroll,\n    showTitles,\n    i18n,\n    validateRestrictions,\n    isLoading,\n    showSearchFilter,\n    search,\n    searchTerm,\n    clearSearch,\n    searchOnInput,\n    searchInputLabel,\n    clearSearchLabel,\n    getNextFolder,\n    cancel,\n    done,\n    columns,\n    noResultsLabel,\n    loadAllFiles,\n  } = props\n\n  const selected = currentSelection.length\n\n  const rows = useMemo(() => [...folders, ...files], [folders, files])\n\n  return (\n    <div\n      className={classNames(\n        'uppy-ProviderBrowser',\n        `uppy-ProviderBrowser-viewType--${viewType}`,\n      )}\n    >\n      {headerComponent && (\n        <div className=\"uppy-ProviderBrowser-header\">\n          <div\n            className={classNames(\n              'uppy-ProviderBrowser-headerBar',\n              !showBreadcrumbs && 'uppy-ProviderBrowser-headerBar--simple',\n            )}\n          >\n            {headerComponent}\n          </div>\n        </div>\n      )}\n\n      {showSearchFilter && (\n        <div class=\"uppy-ProviderBrowser-searchFilter\">\n          <SearchFilterInput\n            search={search}\n            searchTerm={searchTerm}\n            clearSearch={clearSearch}\n            inputLabel={searchInputLabel}\n            clearSearchLabel={clearSearchLabel}\n            inputClassName=\"uppy-ProviderBrowser-searchFilterInput\"\n            searchOnInput={searchOnInput}\n          />\n        </div>\n      )}\n\n      {(() => {\n        if (isLoading) {\n          return (\n            <div className=\"uppy-Provider-loading\">\n              <span>{i18n('loading')}</span>\n            </div>\n          )\n        }\n\n        if (!folders.length && !files.length) {\n          return <div className=\"uppy-Provider-empty\">{noResultsLabel}</div>\n        }\n\n        if (loadAllFiles) {\n          return (\n            <div className=\"uppy-ProviderBrowser-body\">\n              <ul className=\"uppy-ProviderBrowser-list\">\n                <VirtualList\n                  data={rows}\n                  renderRow={(f) => (\n                    <ListItem\n                      currentSelection={currentSelection}\n                      uppyFiles={uppyFiles}\n                      viewType={viewType}\n                      isChecked={isChecked}\n                      toggleCheckbox={toggleCheckbox}\n                      recordShiftKeyPress={recordShiftKeyPress}\n                      showTitles={showTitles}\n                      i18n={i18n}\n                      validateRestrictions={validateRestrictions}\n                      getNextFolder={getNextFolder}\n                      columns={columns}\n                      f={f}\n                    />\n                  )}\n                  rowHeight={31}\n                />\n              </ul>\n            </div>\n          )\n        }\n\n        return (\n          <div className=\"uppy-ProviderBrowser-body\">\n            <ul\n              className=\"uppy-ProviderBrowser-list\"\n              onScroll={handleScroll}\n              role=\"listbox\"\n              // making <ul> not focusable for firefox\n              tabIndex=\"-1\"\n            >\n              {rows.map((f) => (\n                <ListItem\n                  currentSelection={currentSelection}\n                  uppyFiles={uppyFiles}\n                  viewType={viewType}\n                  isChecked={isChecked}\n                  toggleCheckbox={toggleCheckbox}\n                  recordShiftKeyPress={recordShiftKeyPress}\n                  showTitles={showTitles}\n                  i18n={i18n}\n                  validateRestrictions={validateRestrictions}\n                  getNextFolder={getNextFolder}\n                  columns={columns}\n                  f={f}\n                />\n              ))}\n            </ul>\n          </div>\n        )\n      })()}\n\n      {selected > 0 && (\n        <FooterActions\n          selected={selected}\n          done={done}\n          cancel={cancel}\n          i18n={i18n}\n        />\n      )}\n    </div>\n  )\n}\n\nexport default Browser\n"],"mappings":"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"}