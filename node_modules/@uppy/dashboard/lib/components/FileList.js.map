{"version":3,"names":["h","useMemo","VirtualList","FileItem","chunks","list","size","chunked","currentChunk","forEach","item","length","push","_ref","id","error","i18n","uppy","files","acquirers","resumableUploads","hideRetryButton","hidePauseResumeButton","hideCancelButton","showLinkToFileUploadResult","showRemoveButtonAfterComplete","isWide","metaFields","isSingleFile","toggleFileCard","handleRequestThumbnail","handleCancelThumbnail","recoveredState","individualCancellation","itemsPerRow","openFileEditor","canEditFile","toggleAddFilesPanel","containerWidth","containerHeight","rowHeight","rows","sortByGhostComesFirst","file1","file2","isGhost","fileIds","Object","keys","sort","renderRow","row","class","role","key","map","fileID","file","data"],"sources":["FileList.jsx"],"sourcesContent":["import { h } from 'preact'\nimport { useMemo } from 'preact/hooks'\nimport VirtualList from '@uppy/utils/lib/VirtualList'\nimport FileItem from './FileItem/index.jsx'\n\nfunction chunks (list, size) {\n  const chunked = []\n  let currentChunk = []\n  list.forEach((item) => {\n    if (currentChunk.length < size) {\n      currentChunk.push(item)\n    } else {\n      chunked.push(currentChunk)\n      currentChunk = [item]\n    }\n  })\n  if (currentChunk.length) chunked.push(currentChunk)\n  return chunked\n}\n\nexport default ({\n  id, error, i18n, uppy, files, acquirers, resumableUploads, hideRetryButton, hidePauseResumeButton, hideCancelButton,\n  showLinkToFileUploadResult, showRemoveButtonAfterComplete, isWide, metaFields, isSingleFile, toggleFileCard,\n  handleRequestThumbnail, handleCancelThumbnail, recoveredState, individualCancellation, itemsPerRow, openFileEditor,\n  canEditFile, toggleAddFilesPanel, containerWidth, containerHeight,\n}) => {\n  // It's not great that this is hardcoded!\n  // It's ESPECIALLY not great that this is checking against `itemsPerRow`!\n  const rowHeight = itemsPerRow === 1\n    // Mobile\n    ? 71\n    // 190px height + 2 * 5px margin\n    : 200\n\n  // Sort files by file.isGhost, ghost files first, only if recoveredState is present\n  const rows = useMemo(() => {\n    const sortByGhostComesFirst = (file1, file2) => files[file2].isGhost - files[file1].isGhost\n\n    const fileIds = Object.keys(files)\n    if (recoveredState) fileIds.sort(sortByGhostComesFirst)\n    return chunks(fileIds, itemsPerRow)\n  }, [files, itemsPerRow, recoveredState])\n\n  const renderRow = (row) => (\n    // The `role=\"presentation` attribute ensures that the list items are properly\n    // associated with the `VirtualList` element.\n    // We use the first file ID as the keyâ€”this should not change across scroll rerenders\n    <div class=\"uppy-Dashboard-filesInner\" role=\"presentation\" key={row[0]}>\n      {row.map((fileID) => (\n        <FileItem\n          key={fileID}\n          uppy={uppy}\n          // FIXME This is confusing, it's actually the Dashboard's plugin ID\n          id={id}\n          error={error}\n          // TODO move this to context\n          i18n={i18n}\n          // features\n          acquirers={acquirers}\n          resumableUploads={resumableUploads}\n          individualCancellation={individualCancellation}\n          // visual options\n          hideRetryButton={hideRetryButton}\n          hidePauseResumeButton={hidePauseResumeButton}\n          hideCancelButton={hideCancelButton}\n          showLinkToFileUploadResult={showLinkToFileUploadResult}\n          showRemoveButtonAfterComplete={showRemoveButtonAfterComplete}\n          isWide={isWide}\n          metaFields={metaFields}\n          recoveredState={recoveredState}\n          isSingleFile={isSingleFile}\n          containerWidth={containerWidth}\n          containerHeight={containerHeight}\n          // callbacks\n          toggleFileCard={toggleFileCard}\n          handleRequestThumbnail={handleRequestThumbnail}\n          handleCancelThumbnail={handleCancelThumbnail}\n          role=\"listitem\"\n          openFileEditor={openFileEditor}\n          canEditFile={canEditFile}\n          toggleAddFilesPanel={toggleAddFilesPanel}\n          file={files[fileID]}\n        />\n      ))}\n    </div>\n  )\n\n  if (isSingleFile) {\n    return (\n      <div class=\"uppy-Dashboard-files\">\n        {renderRow(rows[0])}\n      </div>\n    )\n  }\n\n  return (\n    <VirtualList\n      class=\"uppy-Dashboard-files\"\n      role=\"list\"\n      data={rows}\n      renderRow={renderRow}\n      rowHeight={rowHeight}\n    />\n  )\n}\n"],"mappings":"AAAA,SAASA,CAAC,QAAQ,QAAQ;AAC1B,SAASC,OAAO,QAAQ,cAAc;AACtC,OAAOC,WAAW,MAAM,6BAA6B;AACrD,OAAOC,QAAQ,MAAM,qBAAsB;AAE3C,SAASC,MAAMA,CAAEC,IAAI,EAAEC,IAAI,EAAE;EAC3B,MAAMC,OAAO,GAAG,EAAE;EAClB,IAAIC,YAAY,GAAG,EAAE;EACrBH,IAAI,CAACI,OAAO,CAAEC,IAAI,IAAK;IACrB,IAAIF,YAAY,CAACG,MAAM,GAAGL,IAAI,EAAE;MAC9BE,YAAY,CAACI,IAAI,CAACF,IAAI,CAAC;IACzB,CAAC,MAAM;MACLH,OAAO,CAACK,IAAI,CAACJ,YAAY,CAAC;MAC1BA,YAAY,GAAG,CAACE,IAAI,CAAC;IACvB;EACF,CAAC,CAAC;EACF,IAAIF,YAAY,CAACG,MAAM,EAAEJ,OAAO,CAACK,IAAI,CAACJ,YAAY,CAAC;EACnD,OAAOD,OAAO;AAChB;AAEA,gBAAeM,IAAA,IAKT;EAAA,IALU;IACdC,EAAE;IAAEC,KAAK;IAAEC,IAAI;IAAEC,IAAI;IAAEC,KAAK;IAAEC,SAAS;IAAEC,gBAAgB;IAAEC,eAAe;IAAEC,qBAAqB;IAAEC,gBAAgB;IACnHC,0BAA0B;IAAEC,6BAA6B;IAAEC,MAAM;IAAEC,UAAU;IAAEC,YAAY;IAAEC,cAAc;IAC3GC,sBAAsB;IAAEC,qBAAqB;IAAEC,cAAc;IAAEC,sBAAsB;IAAEC,WAAW;IAAEC,cAAc;IAClHC,WAAW;IAAEC,mBAAmB;IAAEC,cAAc;IAAEC;EACpD,CAAC,GAAA1B,IAAA;EACC;EACA;EACA,MAAM2B,SAAS,GAAGN,WAAW,KAAK;EAChC;EAAA,EACE;EACF;EAAA,EACE,GAAG;;EAEP;EACA,MAAMO,IAAI,GAAGxC,OAAO,CAAC,MAAM;IACzB,MAAMyC,qBAAqB,GAAGA,CAACC,KAAK,EAAEC,KAAK,KAAK1B,KAAK,CAAC0B,KAAK,CAAC,CAACC,OAAO,GAAG3B,KAAK,CAACyB,KAAK,CAAC,CAACE,OAAO;IAE3F,MAAMC,OAAO,GAAGC,MAAM,CAACC,IAAI,CAAC9B,KAAK,CAAC;IAClC,IAAIc,cAAc,EAAEc,OAAO,CAACG,IAAI,CAACP,qBAAqB,CAAC;IACvD,OAAOtC,MAAM,CAAC0C,OAAO,EAAEZ,WAAW,CAAC;EACrC,CAAC,EAAE,CAAChB,KAAK,EAAEgB,WAAW,EAAEF,cAAc,CAAC,CAAC;EAExC,MAAMkB,SAAS,GAAIC,GAAG;EACpB;EACA;EACA;EACAnD,CAAA;IAAKoD,KAAK,EAAC,2BAA2B;IAACC,IAAI,EAAC,cAAc;IAACC,GAAG,EAAEH,GAAG,CAAC,CAAC;EAAE,GACpEA,GAAG,CAACI,GAAG,CAAEC,MAAM,IACdxD,CAAA,CAACG,QAAQ;IACPmD,GAAG,EAAEE,MAAO;IACZvC,IAAI,EAAEA;IACN;IAAA;IACAH,EAAE,EAAEA,EAAG;IACPC,KAAK,EAAEA;IACP;IAAA;IACAC,IAAI,EAAEA;IACN;IAAA;IACAG,SAAS,EAAEA,SAAU;IACrBC,gBAAgB,EAAEA,gBAAiB;IACnCa,sBAAsB,EAAEA;IACxB;IAAA;IACAZ,eAAe,EAAEA,eAAgB;IACjCC,qBAAqB,EAAEA,qBAAsB;IAC7CC,gBAAgB,EAAEA,gBAAiB;IACnCC,0BAA0B,EAAEA,0BAA2B;IACvDC,6BAA6B,EAAEA,6BAA8B;IAC7DC,MAAM,EAAEA,MAAO;IACfC,UAAU,EAAEA,UAAW;IACvBK,cAAc,EAAEA,cAAe;IAC/BJ,YAAY,EAAEA,YAAa;IAC3BU,cAAc,EAAEA,cAAe;IAC/BC,eAAe,EAAEA;IACjB;IAAA;IACAV,cAAc,EAAEA,cAAe;IAC/BC,sBAAsB,EAAEA,sBAAuB;IAC/CC,qBAAqB,EAAEA,qBAAsB;IAC7CsB,IAAI,EAAC,UAAU;IACflB,cAAc,EAAEA,cAAe;IAC/BC,WAAW,EAAEA,WAAY;IACzBC,mBAAmB,EAAEA,mBAAoB;IACzCoB,IAAI,EAAEvC,KAAK,CAACsC,MAAM;EAAE,CACrB,CACF,CACE,CACN;EAED,IAAI5B,YAAY,EAAE;IAChB,OACE5B,CAAA;MAAKoD,KAAK,EAAC;IAAsB,GAC9BF,SAAS,CAACT,IAAI,CAAC,CAAC,CAAC,CACf,CAAC;EAEV;EAEA,OACEzC,CAAA,CAACE,WAAW;IACVkD,KAAK,EAAC,sBAAsB;IAC5BC,IAAI,EAAC,MAAM;IACXK,IAAI,EAAEjB,IAAK;IACXS,SAAS,EAAEA,SAAU;IACrBV,SAAS,EAAEA;EAAU,CACtB,CAAC;AAEN,CAAC"}