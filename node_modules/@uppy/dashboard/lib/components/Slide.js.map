{"version":3,"names":["cloneElement","Component","toChildArray","classNames","transitionName","duration","Slide","constructor","props","state","cachedChildren","className","componentWillUpdate","nextProps","child","children","patch","cancelAnimationFrame","animationFrame","clearTimeout","leaveTimeout","undefined","requestAnimationFrame","setState","enterTimeout","setTimeout","render"],"sources":["Slide.jsx"],"sourcesContent":["import {  cloneElement, Component, toChildArray  } from 'preact'\nimport classNames from 'classnames'\n\nconst transitionName = 'uppy-transition-slideDownUp'\nconst duration = 250\n\n/**\n * Vertical slide transition.\n *\n * This can take a _single_ child component, which _must_ accept a `className` prop.\n *\n * Currently this is specific to the `uppy-transition-slideDownUp` transition,\n * but it should be simple to extend this for any type of single-element\n * transition by setting the CSS name and duration as props.\n */\nclass Slide extends Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      cachedChildren: null,\n      className: '',\n    }\n  }\n\n  // TODO: refactor to stable lifecycle method\n  // eslint-disable-next-line\n  componentWillUpdate (nextProps) {\n    const { cachedChildren } = this.state\n    const child = toChildArray(nextProps.children)[0]\n\n    if (cachedChildren === child) return null\n\n    const patch = {\n      cachedChildren: child,\n    }\n\n    // Enter transition\n    if (child && !cachedChildren) {\n      patch.className = `${transitionName}-enter`\n\n      cancelAnimationFrame(this.animationFrame)\n      clearTimeout(this.leaveTimeout)\n      this.leaveTimeout = undefined\n\n      this.animationFrame = requestAnimationFrame(() => {\n        // Force it to render before we add the active class\n        // this.base.getBoundingClientRect()\n\n        this.setState({\n          className: `${transitionName}-enter ${transitionName}-enter-active`,\n        })\n\n        this.enterTimeout = setTimeout(() => {\n          this.setState({ className: '' })\n        }, duration)\n      })\n    }\n\n    // Leave transition\n    if (cachedChildren && !child && this.leaveTimeout === undefined) {\n      patch.cachedChildren = cachedChildren\n      patch.className = `${transitionName}-leave`\n\n      cancelAnimationFrame(this.animationFrame)\n      clearTimeout(this.enterTimeout)\n      this.enterTimeout = undefined\n      this.animationFrame = requestAnimationFrame(() => {\n        this.setState({\n          className: `${transitionName}-leave ${transitionName}-leave-active`,\n        })\n\n        this.leaveTimeout = setTimeout(() => {\n          this.setState({\n            cachedChildren: null,\n            className: '',\n          })\n        }, duration)\n      })\n    }\n\n    // eslint-disable-next-line\n    this.setState(patch)\n  }\n\n  render () {\n    const { cachedChildren, className } = this.state\n\n    if (!cachedChildren) {\n      return null\n    }\n\n    return cloneElement(cachedChildren, {\n      className: classNames(className, cachedChildren.props.className),\n    })\n  }\n}\n\nexport default Slide\n"],"mappings":"AAAA,SAAUA,YAAY,EAAEC,SAAS,EAAEC,YAAY,QAAS,QAAQ;AAChE,OAAOC,UAAU,MAAM,YAAY;AAEnC,MAAMC,cAAc,GAAG,6BAA6B;AACpD,MAAMC,QAAQ,GAAG,GAAG;;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,KAAK,SAASL,SAAS,CAAC;EAC5BM,WAAWA,CAAEC,KAAK,EAAE;IAClB,KAAK,CAACA,KAAK,CAAC;IAEZ,IAAI,CAACC,KAAK,GAAG;MACXC,cAAc,EAAE,IAAI;MACpBC,SAAS,EAAE;IACb,CAAC;EACH;;EAEA;EACA;EACAC,mBAAmBA,CAAEC,SAAS,EAAE;IAC9B,MAAM;MAAEH;IAAe,CAAC,GAAG,IAAI,CAACD,KAAK;IACrC,MAAMK,KAAK,GAAGZ,YAAY,CAACW,SAAS,CAACE,QAAQ,CAAC,CAAC,CAAC,CAAC;IAEjD,IAAIL,cAAc,KAAKI,KAAK,EAAE,OAAO,IAAI;IAEzC,MAAME,KAAK,GAAG;MACZN,cAAc,EAAEI;IAClB,CAAC;;IAED;IACA,IAAIA,KAAK,IAAI,CAACJ,cAAc,EAAE;MAC5BM,KAAK,CAACL,SAAS,GAAI,GAAEP,cAAe,QAAO;MAE3Ca,oBAAoB,CAAC,IAAI,CAACC,cAAc,CAAC;MACzCC,YAAY,CAAC,IAAI,CAACC,YAAY,CAAC;MAC/B,IAAI,CAACA,YAAY,GAAGC,SAAS;MAE7B,IAAI,CAACH,cAAc,GAAGI,qBAAqB,CAAC,MAAM;QAChD;QACA;;QAEA,IAAI,CAACC,QAAQ,CAAC;UACZZ,SAAS,EAAG,GAAEP,cAAe,UAASA,cAAe;QACvD,CAAC,CAAC;QAEF,IAAI,CAACoB,YAAY,GAAGC,UAAU,CAAC,MAAM;UACnC,IAAI,CAACF,QAAQ,CAAC;YAAEZ,SAAS,EAAE;UAAG,CAAC,CAAC;QAClC,CAAC,EAAEN,QAAQ,CAAC;MACd,CAAC,CAAC;IACJ;;IAEA;IACA,IAAIK,cAAc,IAAI,CAACI,KAAK,IAAI,IAAI,CAACM,YAAY,KAAKC,SAAS,EAAE;MAC/DL,KAAK,CAACN,cAAc,GAAGA,cAAc;MACrCM,KAAK,CAACL,SAAS,GAAI,GAAEP,cAAe,QAAO;MAE3Ca,oBAAoB,CAAC,IAAI,CAACC,cAAc,CAAC;MACzCC,YAAY,CAAC,IAAI,CAACK,YAAY,CAAC;MAC/B,IAAI,CAACA,YAAY,GAAGH,SAAS;MAC7B,IAAI,CAACH,cAAc,GAAGI,qBAAqB,CAAC,MAAM;QAChD,IAAI,CAACC,QAAQ,CAAC;UACZZ,SAAS,EAAG,GAAEP,cAAe,UAASA,cAAe;QACvD,CAAC,CAAC;QAEF,IAAI,CAACgB,YAAY,GAAGK,UAAU,CAAC,MAAM;UACnC,IAAI,CAACF,QAAQ,CAAC;YACZb,cAAc,EAAE,IAAI;YACpBC,SAAS,EAAE;UACb,CAAC,CAAC;QACJ,CAAC,EAAEN,QAAQ,CAAC;MACd,CAAC,CAAC;IACJ;;IAEA;IACA,IAAI,CAACkB,QAAQ,CAACP,KAAK,CAAC;EACtB;EAEAU,MAAMA,CAAA,EAAI;IACR,MAAM;MAAEhB,cAAc;MAAEC;IAAU,CAAC,GAAG,IAAI,CAACF,KAAK;IAEhD,IAAI,CAACC,cAAc,EAAE;MACnB,OAAO,IAAI;IACb;IAEA,OAAOV,YAAY,CAACU,cAAc,EAAE;MAClCC,SAAS,EAAER,UAAU,CAACQ,SAAS,EAAED,cAAc,CAACF,KAAK,CAACG,SAAS;IACjE,CAAC,CAAC;EACJ;AACF;AAEA,eAAeL,KAAK"}