{"version":3,"names":["ProgressTimeout","constructor","timeout","timeoutHandler","Object","defineProperty","_aliveTimer","writable","value","_isDone","_onTimedOut","_timeout","_classPrivateFieldLooseBase","progress","clearTimeout","setTimeout","done"],"sources":["ProgressTimeout.js"],"sourcesContent":["/**\n * Helper to abort upload requests if there has not been any progress for `timeout` ms.\n * Create an instance using `timer = new ProgressTimeout(10000, onTimeout)`\n * Call `timer.progress()` to signal that there has been progress of any kind.\n * Call `timer.done()` when the upload has completed.\n */\nclass ProgressTimeout {\n  #aliveTimer\n\n  #isDone = false\n\n  #onTimedOut\n\n  #timeout\n\n  constructor (timeout, timeoutHandler) {\n    this.#timeout = timeout\n    this.#onTimedOut = timeoutHandler\n  }\n\n  progress () {\n    // Some browsers fire another progress event when the upload is\n    // cancelled, so we have to ignore progress after the timer was\n    // told to stop.\n    if (this.#isDone) return\n\n    if (this.#timeout > 0) {\n      clearTimeout(this.#aliveTimer)\n      this.#aliveTimer = setTimeout(this.#onTimedOut, this.#timeout)\n    }\n  }\n\n  done () {\n    if (!this.#isDone) {\n      clearTimeout(this.#aliveTimer)\n      this.#aliveTimer = null\n      this.#isDone = true\n    }\n  }\n}\n\nexport default ProgressTimeout\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,eAAe,CAAC;EASpBC,WAAWA,CAAEC,OAAO,EAAEC,cAAc,EAAE;IAAAC,MAAA,CAAAC,cAAA,OAAAC,WAAA;MAAAC,QAAA;MAAAC,KAAA;IAAA;IAAAJ,MAAA,CAAAC,cAAA,OAAAI,OAAA;MAAAF,QAAA;MAAAC,KAAA,EAN5B;IAAK;IAAAJ,MAAA,CAAAC,cAAA,OAAAK,WAAA;MAAAH,QAAA;MAAAC,KAAA;IAAA;IAAAJ,MAAA,CAAAC,cAAA,OAAAM,QAAA;MAAAJ,QAAA;MAAAC,KAAA;IAAA;IAObI,2BAAA,KAAI,EAAAD,QAAA,EAAAA,QAAA,IAAYT,OAAO;IACvBU,2BAAA,KAAI,EAAAF,WAAA,EAAAA,WAAA,IAAeP,cAAc;EACnC;EAEAU,QAAQA,CAAA,EAAI;IACV;IACA;IACA;IACA,IAAAD,2BAAA,CAAI,IAAI,EAAAH,OAAA,EAAAA,OAAA,GAAU;IAElB,IAAIG,2BAAA,KAAI,EAAAD,QAAA,EAAAA,QAAA,IAAY,CAAC,EAAE;MACrBG,YAAY,CAAAF,2BAAA,CAAC,IAAI,EAAAN,WAAA,EAAAA,WAAA,CAAY,CAAC;MAC9BM,2BAAA,KAAI,EAAAN,WAAA,EAAAA,WAAA,IAAeS,UAAU,CAAAH,2BAAA,CAAC,IAAI,EAAAF,WAAA,EAAAA,WAAA,GAAAE,2BAAA,CAAc,IAAI,EAAAD,QAAA,EAAAA,QAAA,CAAS,CAAC;IAChE;EACF;EAEAK,IAAIA,CAAA,EAAI;IACN,IAAI,CAAAJ,2BAAA,CAAC,IAAI,EAAAH,OAAA,EAAAA,OAAA,CAAQ,EAAE;MACjBK,YAAY,CAAAF,2BAAA,CAAC,IAAI,EAAAN,WAAA,EAAAA,WAAA,CAAY,CAAC;MAC9BM,2BAAA,KAAI,EAAAN,WAAA,EAAAA,WAAA,IAAe,IAAI;MACvBM,2BAAA,KAAI,EAAAH,OAAA,EAAAA,OAAA,IAAW,IAAI;IACrB;EACF;AACF;AAEA,eAAeT,eAAe"}